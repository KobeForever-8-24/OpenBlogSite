{"version":3,"file":"local-memory-storage.cjs.development.js","sources":["../src/index.ts"],"sourcesContent":["export class LocalMemoryStorage implements Storage {\n  #data = new Map();\n\n  constructor() {\n    return new Proxy(this, {\n      // reveal keys in Reflect.ownKeys()\n      ownKeys: () => {\n        return Array.from(this.#data.keys());\n      },\n\n      // reveal keys in Object.keys()\n      getOwnPropertyDescriptor: (target, prop) => {\n        const hasKey = target.#data.has(prop);\n        const value = hasKey ? target.getItem(prop) : undefined;\n        return {\n          value,\n          writable: false,\n          enumerable: hasKey,\n          configurable: true,\n        };\n      },\n\n      // bind methods to target, otherwise calls that access private class fields\n      // will have the proxy as their context and calls will fail with:\n      // \"Cannot read private member from an object whose class did not declare it\"\n      get: (target, name) => {\n        let ret = Reflect.get(target, name);\n        if (typeof ret === 'function') {\n          return ret.bind(target);\n        }\n        // otherwise retrieve the value of the corresponding key (e.g. for Object.values)\n        return this.getItem(name);\n      },\n      set: (target, name, value) => {\n        return Reflect.set(target, name, value);\n      },\n    });\n  }\n\n  get length(): number {\n    return this.#data.size;\n  }\n\n  key(index: number): string | null {\n    if (arguments.length === 0) {\n      throw new TypeError('MemoryWebStorage requires 1 argument, received 0.');\n    }\n    return Array.from(this.#data.keys())[index];\n  }\n\n  getItem(key: unknown): string | null {\n    return this.#data.has(key) ? this.#data.get(key) : null;\n  }\n\n  setItem(key: string, value: string): void {\n    this.#data.set(String(key), String(value));\n  }\n\n  removeItem(key: string): void {\n    this.#data.delete(key);\n  }\n\n  clear() {\n    this.#data.clear();\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'LocalMemoryStorage';\n  }\n}\n\n// Required to avoid typescript erroring when accessing value by index\nexport interface LocalMemoryStorage extends Storage {\n  // Element implicitly has an 'any' type because expression of type '\"a\"' can't be used to index type 'LocalMemoryStorage'.\n}\n\nexport const memoryStorage = new LocalMemoryStorage();\nexport default LocalMemoryStorage;\n"],"names":["Symbol","toStringTag","LocalMemoryStorage","Map","Proxy","ownKeys","Array","from","keys","getOwnPropertyDescriptor","target","prop","hasKey","has","value","getItem","undefined","writable","enumerable","configurable","get","name","ret","Reflect","bind","set","key","index","arguments","length","TypeError","setItem","String","removeItem","clear","size","memoryStorage"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sBAkEOA,MAAM,CAACC;IAlEDC,kBAAb;AAGE;;;;;;;AAFA,sDAAQ,IAAIC,GAAJ,EAAR;AAGE,WAAO,IAAIC,KAAJ,CAAU,IAAV,EAAgB;AACrB;AACAC,MAAAA,OAAO,EAAE;AACP,eAAOC,KAAK,CAACC,IAAN,CAAW,4BAAA,KAAI,QAAJ,QAAWC,IAAX,EAAX,CAAP;AACD,OAJoB;AAMrB;AACAC,MAAAA,wBAAwB,EAAE,kCAACC,MAAD,EAASC,IAAT;AACxB,YAAMC,MAAM,GAAG,4BAAAF,MAAM,QAAN,QAAaG,GAAb,CAAiBF,IAAjB,CAAf;;AACA,YAAMG,KAAK,GAAGF,MAAM,GAAGF,MAAM,CAACK,OAAP,CAAeJ,IAAf,CAAH,GAA0BK,SAA9C;AACA,eAAO;AACLF,UAAAA,KAAK,EAALA,KADK;AAELG,UAAAA,QAAQ,EAAE,KAFL;AAGLC,UAAAA,UAAU,EAAEN,MAHP;AAILO,UAAAA,YAAY,EAAE;AAJT,SAAP;AAMD,OAhBoB;AAkBrB;AACA;AACA;AACAC,MAAAA,GAAG,EAAE,aAACV,MAAD,EAASW,IAAT;AACH,YAAIC,GAAG,GAAGC,OAAO,CAACH,GAAR,CAAYV,MAAZ,EAAoBW,IAApB,CAAV;;AACA,YAAI,OAAOC,GAAP,KAAe,UAAnB,EAA+B;AAC7B,iBAAOA,GAAG,CAACE,IAAJ,CAASd,MAAT,CAAP;AACD;;;AAED,eAAO,KAAI,CAACK,OAAL,CAAaM,IAAb,CAAP;AACD,OA5BoB;AA6BrBI,MAAAA,GAAG,EAAE,aAACf,MAAD,EAASW,IAAT,EAAeP,KAAf;AACH,eAAOS,OAAO,CAACE,GAAR,CAAYf,MAAZ,EAAoBW,IAApB,EAA0BP,KAA1B,CAAP;AACD;AA/BoB,KAAhB,CAAP;AAiCD;;AArCH;;AAAA,SA2CEY,GA3CF,GA2CE,aAAIC,KAAJ;AACE,QAAIC,SAAS,CAACC,MAAV,KAAqB,CAAzB,EAA4B;AAC1B,YAAM,IAAIC,SAAJ,CAAc,mDAAd,CAAN;AACD;;AACD,WAAOxB,KAAK,CAACC,IAAN,CAAW,gDAAWC,IAAX,EAAX,EAA8BmB,KAA9B,CAAP;AACD,GAhDH;;AAAA,SAkDEZ,OAlDF,GAkDE,iBAAQW,GAAR;AACE,WAAO,gDAAWb,GAAX,CAAea,GAAf,IAAsB,gDAAWN,GAAX,CAAeM,GAAf,CAAtB,GAA4C,IAAnD;AACD,GApDH;;AAAA,SAsDEK,OAtDF,GAsDE,iBAAQL,GAAR,EAAqBZ,KAArB;AACE,oDAAWW,GAAX,CAAeO,MAAM,CAACN,GAAD,CAArB,EAA4BM,MAAM,CAAClB,KAAD,CAAlC;AACD,GAxDH;;AAAA,SA0DEmB,UA1DF,GA0DE,oBAAWP,GAAX;AACE,8DAAkBA,GAAlB;AACD,GA5DH;;AAAA,SA8DEQ,KA9DF,GA8DE;AACE,oDAAWA,KAAX;AACD,GAhEH;;AAAA;AAAA;AAAA,SAuCE;AACE,aAAO,gDAAWC,IAAlB;AACD;AAzCH;AAAA;AAAA,SAkEE;AACE,aAAO,oBAAP;AACD;AApEH;;AAAA;AAAA;IA4EaC,aAAa,gBAAG,IAAIlC,kBAAJ;;;;;;"}